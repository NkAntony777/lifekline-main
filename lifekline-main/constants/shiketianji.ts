import { GanType, ZhiType, ShishenType, LongevityType } from '../types/shiketianji';

export const TIAN_GAN: GanType[] = ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'];

export const DI_ZHI: ZhiType[] = ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'];

export const WUXING_COLORS: Record<GanType | ZhiType, string> = {
  '甲': '#317023', '乙': '#317023',
  '丙': '#ce2d20', '丁': '#ce2d20',
  '戊': '#98511e', '己': '#98511e',
  '庚': '#e08433', '辛': '#e08433',
  '壬': '#0803a8', '癸': '#0803a8',
  '子': '#0803a8', '丑': '#98511e', '寅': '#317023',
  '卯': '#317023', '辰': '#98511e', '巳': '#ce2d20',
  '午': '#ce2d20', '未': '#98511e', '申': '#e08433',
  '酉': '#e08433', '戌': '#98511e', '亥': '#0803a8'
};

export const VALID_GANZHI_PAIRS: string[] = [
  '甲子', '乙丑', '丙寅', '丁卯', '戊辰', '己巳', '庚午', '辛未', '壬申', '癸酉',
  '甲戌', '乙亥', '丙子', '丁丑', '戊寅', '己卯', '庚辰', '辛巳', '壬午', '癸未',
  '甲申', '乙酉', '丙戌', '丁亥', '戊子', '己丑', '庚寅', '辛卯', '壬辰', '癸巳',
  '甲午', '乙未', '丙申', '丁酉', '戊戌', '己亥', '庚子', '辛丑', '壬寅', '癸卯',
  '甲辰', '乙巳', '丙午', '丁未', '戊申', '己酉', '庚戌', '辛亥', '壬子', '癸丑',
  '甲寅', '乙卯', '丙辰', '丁巳', '戊午', '己未', '庚申', '辛酉', '壬戌', '癸亥'
];

export const GAN_TO_ZHI_MAP: Record<GanType, ZhiType[]> = {
  '甲': ['子', '寅', '辰', '午', '申', '戌'],
  '乙': ['丑', '卯', '巳', '未', '酉', '亥'],
  '丙': ['寅', '辰', '午', '申', '戌', '子'],
  '丁': ['卯', '巳', '未', '酉', '亥', '丑'],
  '戊': ['辰', '午', '申', '戌', '子', '寅'],
  '己': ['巳', '未', '酉', '亥', '丑', '卯'],
  '庚': ['午', '申', '戌', '子', '寅', '辰'],
  '辛': ['未', '酉', '亥', '丑', '卯', '巳'],
  '壬': ['申', '戌', '子', '寅', '辰', '午'],
  '癸': ['酉', '亥', '丑', '卯', '巳', '未']
};

export const XUN_KONG_MAP: Record<string, string> = (() => {
  const map: Record<string, string> = {};
  const xunKongPairs = ['戌、亥', '申、酉', '午、未', '辰、巳', '寅、卯', '子、丑'];
  
  for (let i = 0; i < 60; i++) {
    const ganIndex = i % 10;
    const zhiIndex = i % 12;
    const ganZhi = TIAN_GAN[ganIndex] + DI_ZHI[zhiIndex];
    const xunIndex = Math.floor(i / 10);
    map[ganZhi] = xunKongPairs[xunIndex];
  }
  
  return map;
})();

export const TWELVE_LONGEVITY: LongevityType[] = [
  '长生', '沐浴', '冠带', '临官', '帝旺',
  '衰', '病', '死', '墓', '绝', '胎', '养'
];

export const TEN_HEAVENLY_STEMS_LONGEVITY_TABLE: Record<GanType, ZhiType[]> = {
  '甲': ['亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌'],
  '乙': ['亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌'],
  '丙': ['寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑'],
  '丁': ['寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑'],
  '戊': ['申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未'],
  '己': ['申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未'],
  '庚': ['巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰'],
  '辛': ['巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰'],
  '壬': ['申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未'],
  '癸': ['申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未']
};

export const LONGEVITY_MAP: Record<GanType, Record<ZhiType, LongevityType>> = (() => {
  const map: Record<GanType, Record<ZhiType, LongevityType>> = {} as any;
  
  Object.entries(TEN_HEAVENLY_STEMS_LONGEVITY_TABLE).forEach(([gan, zhiList]) => {
    map[gan as GanType] = {} as any;
    zhiList.forEach((zhi, index) => {
      map[gan as GanType][zhi as ZhiType] = TWELVE_LONGEVITY[index];
    });
  });
  
  return map;
})();

export const NAYIN_MAP: Record<string, string> = {
  '甲子': '海中金', '乙丑': '海中金', '丙寅': '炉中火', '丁卯': '炉中火',
  '戊辰': '大林木', '己巳': '大林木', '庚午': '路旁土', '辛未': '路旁土',
  '壬申': '剑锋金', '癸酉': '剑锋金', '甲戌': '山头火', '乙亥': '山头火',
  '丙子': '洞下水', '丁丑': '洞下水', '戊寅': '城头土', '己卯': '城头土',
  '庚辰': '白蜡金', '辛巳': '白蜡金', '壬午': '杨柳木', '癸未': '杨柳木',
  '甲申': '泉中水', '乙酉': '泉中水', '丙戌': '屋上土', '丁亥': '屋上土',
  '戊子': '霹雳火', '己丑': '霹雳火', '庚寅': '松柏木', '辛卯': '松柏木',
  '壬辰': '长流水', '癸巳': '长流水', '甲午': '砂中金', '乙未': '砂中金',
  '丙申': '山下火', '丁酉': '山下火', '戊戌': '平地木', '己亥': '平地木',
  '庚子': '壁上土', '辛丑': '壁上土', '壬寅': '金箔金', '癸卯': '金箔金',
  '甲辰': '覆灯火', '乙巳': '覆灯火', '丙午': '天河水', '丁未': '天河水',
  '戊申': '大驿土', '己酉': '大驿土', '庚戌': '钗钏金', '辛亥': '钗钏金',
  '壬子': '桑柘木', '癸丑': '桑柘木', '甲寅': '大溪水', '乙卯': '大溪水',
  '丙辰': '沙中土', '丁巳': '沙中土', '戊午': '天上火', '己未': '天上火',
  '庚申': '石榴木', '辛酉': '石榴木', '壬戌': '大海水', '癸亥': '大海水'
};

export const NAYIN_COLORS: Record<string, string> = {
  '金': '#e08433',
  '木': '#317023',
  '水': '#0803a8',
  '火': '#ce2d20',
  '土': '#98511e'
};

export const TOUGAN_MAP: Record<ZhiType, GanType[]> = {
  '子': ['癸'],
  '丑': ['己', '癸', '辛'],
  '寅': ['甲', '丙', '戊'],
  '卯': ['乙'],
  '辰': ['戊', '乙', '癸'],
  '巳': ['丙', '庚', '戊'],
  '午': ['丁', '己'],
  '未': ['己', '丁', '乙'],
  '申': ['庚', '壬', '戊'],
  '酉': ['辛'],
  '戌': ['戊', '辛', '丁'],
  '亥': ['壬', '甲']
};

export const SHISHEN_MAP: Record<GanType, Record<GanType, ShishenType>> = {
  '甲': { '甲': '比肩', '乙': '劫财', '丙': '食神', '丁': '伤官', '戊': '偏财', '己': '正财', '庚': '七杀', '辛': '正官', '壬': '偏印', '癸': '正印' },
  '乙': { '甲': '劫财', '乙': '比肩', '丙': '伤官', '丁': '食神', '戊': '正财', '己': '偏财', '庚': '正官', '辛': '七杀', '壬': '正印', '癸': '偏印' },
  '丙': { '甲': '偏印', '乙': '正印', '丙': '比肩', '丁': '劫财', '戊': '食神', '己': '伤官', '庚': '偏财', '辛': '正财', '壬': '七杀', '癸': '正官' },
  '丁': { '甲': '正印', '乙': '偏印', '丙': '劫财', '丁': '比肩', '戊': '伤官', '己': '食神', '庚': '正财', '辛': '偏财', '壬': '正官', '癸': '七杀' },
  '戊': { '甲': '七杀', '乙': '正官', '丙': '偏印', '丁': '正印', '戊': '比肩', '己': '劫财', '庚': '食神', '辛': '伤官', '壬': '偏财', '癸': '正财' },
  '己': { '甲': '正官', '乙': '七杀', '丙': '正印', '丁': '偏印', '戊': '劫财', '己': '比肩', '庚': '伤官', '辛': '食神', '壬': '正财', '癸': '偏财' },
  '庚': { '甲': '偏财', '乙': '正财', '丙': '七杀', '丁': '正官', '戊': '偏印', '己': '正印', '庚': '比肩', '辛': '劫财', '壬': '食神', '癸': '伤官' },
  '辛': { '甲': '正财', '乙': '偏财', '丙': '正官', '丁': '七杀', '戊': '正印', '己': '偏印', '庚': '劫财', '辛': '比肩', '壬': '伤官', '癸': '食神' },
  '壬': { '甲': '食神', '乙': '伤官', '丙': '偏财', '丁': '正财', '戊': '七杀', '己': '正官', '庚': '偏印', '辛': '正印', '壬': '比肩', '癸': '劫财' },
  '癸': { '甲': '伤官', '乙': '食神', '丙': '正财', '丁': '偏财', '戊': '正官', '己': '七杀', '庚': '正印', '辛': '偏印', '壬': '劫财', '癸': '比肩' }
};

export const TIANGAN_SHENSHA: Record<string, Record<GanType, string>> = {
  '贵人': { '甲': '丑、未', '乙': '子、申', '丙': '亥、酉', '丁': '亥、酉', '戊': '丑、未', '己': '子、申', '庚': '丑、未', '辛': '寅、午', '壬': '卯、巳', '癸': '卯、巳' },
  '沐浴': { '甲': '亥', '乙': '亥', '丙': '卯', '丁': '卯', '戊': '酉', '己': '酉', '庚': '午', '辛': '午', '壬': '酉', '癸': '酉' },
  '干禄': { '甲': '寅', '乙': '卯', '丙': '巳', '丁': '午', '戊': '巳', '己': '午', '庚': '申', '辛': '酉', '壬': '亥', '癸': '子' },
  '羊刃': { '甲': '卯', '乙': '辰', '丙': '午', '丁': '未', '戊': '午', '己': '未', '庚': '酉', '辛': '戌', '壬': '子', '癸': '丑' },
  '飞刃': { '甲': '酉', '乙': '戌', '丙': '子', '丁': '丑', '戊': '子', '己': '丑', '庚': '卯', '辛': '辰', '壬': '午', '癸': '未' },
  '红艳': { '甲': '午', '乙': '未', '丙': '申', '丁': '酉', '戊': '辰', '己': '巳', '庚': '子', '辛': '丑', '壬': '寅', '癸': '卯' },
  '金舆': { '甲': '辰', '乙': '未', '丙': '未', '丁': '未', '戊': '辰', '己': '辰', '庚': '未', '辛': '未', '壬': '戌', '癸': '戌' },
  '学堂': { '甲': '亥', '乙': '亥', '丙': '寅', '丁': '寅', '戊': '申', '己': '申', '庚': '巳', '辛': '巳', '壬': '申', '癸': '申' }
};

export const DIZHI_SHENSHA: Record<string, Record<ZhiType, string>> = {
  '驿马': { '子': '寅', '丑': '卯', '寅': '申', '卯': '巳', '辰': '寅', '巳': '亥', '午': '申', '未': '巳', '申': '寅', '酉': '亥', '戌': '申', '亥': '巳' },
  '华盖': { '子': '辰', '丑': '丑', '寅': '戌', '卯': '未', '辰': '辰', '巳': '丑', '午': '戌', '未': '未', '申': '辰', '酉': '丑', '戌': '戌', '亥': '未' },
  '桃花': { '申': '酉', '子': '酉', '辰': '酉', '寅': '卯', '午': '卯', '戌': '卯', '巳': '午', '酉': '午', '丑': '午', '亥': '子', '卯': '子', '未': '子' },
  '红鸾': { '子': '卯', '丑': '寅', '寅': '丑', '卯': '子', '辰': '亥', '巳': '戌', '午': '酉', '未': '申', '申': '未', '酉': '午', '戌': '巳', '亥': '辰' },
  '天喜': { '子': '酉', '丑': '戌', '寅': '未', '卯': '午', '辰': '巳', '巳': '辰', '午': '卯', '未': '寅', '申': '丑', '酉': '子', '戌': '亥', '亥': '申' },
  '孤辰': { '子': '寅', '丑': '寅', '寅': '巳', '卯': '巳', '辰': '巳', '巳': '申', '午': '申', '未': '申', '申': '亥', '酉': '亥', '戌': '亥', '亥': '寅' },
  '寡宿': { '子': '戌', '丑': '戌', '寅': '丑', '卯': '丑', '辰': '丑', '巳': '辰', '午': '辰', '未': '辰', '申': '未', '酉': '未', '戌': '未', '亥': '戌' },
  '亡神': { '子': '亥', '丑': '亥', '寅': '寅', '卯': '寅', '辰': '寅', '巳': '巳', '午': '巳', '未': '巳', '申': '申', '酉': '申', '戌': '申', '亥': '亥' },
  '劫煞': { '子': '巳', '丑': '寅', '寅': '亥', '卯': '申', '辰': '巳', '巳': '寅', '午': '亥', '未': '申', '申': '巳', '酉': '寅', '戌': '亥', '亥': '申' },
  '丧门': { '子': '寅', '丑': '丑', '寅': '子', '卯': '亥', '辰': '戌', '巳': '酉', '午': '申', '未': '未', '申': '午', '酉': '巳', '戌': '辰', '亥': '卯' },
  '吊客': { '子': '戌', '丑': '亥', '寅': '子', '卯': '丑', '辰': '寅', '巳': '卯', '午': '辰', '未': '巳', '申': '午', '酉': '未', '戌': '申', '亥': '酉' }
};

export const SHENSHA_ORDER = {
  tiangan: ['贵人', '干禄', '羊刃', '飞刃', '红艳', '金舆', '学堂'],
  dizhi: ['驿马', '华盖', '桃花', '红鸾', '天喜', '孤辰', '寡宿', '亡神', '劫煞', '丧门', '吊客']
};

export const NAYIN_LONGEVITY_MAP: Record<string, ZhiType> = {
  '海中金': '巳',
  '炉中火': '寅',
  '大林木': '亥',
  '路旁土': '申',
  '剑锋金': '巳',
  '山头火': '寅',
  '洞下水': '申',
  '城头土': '申',
  '白蜡金': '巳',
  '杨柳木': '亥',
  '泉中水': '申',
  '屋上土': '申',
  '霹雳火': '寅',
  '松柏木': '亥',
  '长流水': '申',
  '砂中金': '巳',
  '山下火': '寅',
  '平地木': '亥',
  '壁上土': '申',
  '金箔金': '巳',
  '覆灯火': '寅',
  '天河水': '申',
  '大驿土': '申',
  '钗钏金': '巳',
  '桑柘木': '亥',
  '大溪水': '申',
  '沙中土': '申',
  '天上火': '寅',
  '石榴木': '亥',
  '大海水': '申'
};

export const NAYIN_LONGEVITY_TABLE: Record<ZhiType, LongevityType[]> = {
  '子': ['胎', '养', '长生', '沐浴', '冠带', '临官', '帝旺', '衰', '病', '死', '墓', '绝'],
  '丑': ['绝', '胎', '养', '长生', '沐浴', '冠带', '临官', '帝旺', '衰', '病', '死', '墓'],
  '寅': ['墓', '绝', '胎', '养', '长生', '沐浴', '冠带', '临官', '帝旺', '衰', '病', '死'],
  '卯': ['死', '墓', '绝', '胎', '养', '长生', '沐浴', '冠带', '临官', '帝旺', '衰', '病'],
  '辰': ['病', '死', '墓', '绝', '胎', '养', '长生', '沐浴', '冠带', '临官', '帝旺', '衰'],
  '巳': ['衰', '病', '死', '墓', '绝', '胎', '养', '长生', '沐浴', '冠带', '临官', '帝旺'],
  '午': ['帝旺', '衰', '病', '死', '墓', '绝', '胎', '养', '长生', '沐浴', '冠带', '临官'],
  '未': ['临官', '帝旺', '衰', '病', '死', '墓', '绝', '胎', '养', '长生', '沐浴', '冠带'],
  '申': ['冠带', '临官', '帝旺', '衰', '病', '死', '墓', '绝', '胎', '养', '长生', '沐浴'],
  '酉': ['沐浴', '冠带', '临官', '帝旺', '衰', '病', '死', '墓', '绝', '胎', '养', '长生'],
  '戌': ['长生', '沐浴', '冠带', '临官', '帝旺', '衰', '病', '死', '墓', '绝', '胎', '养'],
  '亥': ['养', '长生', '沐浴', '冠带', '临官', '帝旺', '衰', '病', '死', '墓', '绝', '胎']
};

export const NAYIN_TO_WUXING: Record<string, GanType> = {
  '海中金': '庚',
  '剑锋金': '庚',
  '白蜡金': '庚',
  '砂中金': '庚',
  '金箔金': '庚',
  '钗钏金': '庚',
  '大林木': '甲',
  '杨柳木': '甲',
  '松柏木': '甲',
  '平地木': '甲',
  '桑柘木': '甲',
  '石榴木': '甲',
  '洞下水': '壬',
  '泉中水': '壬',
  '长流水': '壬',
  '天河水': '壬',
  '大溪水': '壬',
  '大海水': '壬',
  '炉中火': '丙',
  '山头火': '丙',
  '霹雳火': '丙',
  '山下火': '丙',
  '覆灯火': '丙',
  '天上火': '丙',
  '路旁土': '戊',
  '城头土': '戊',
  '屋上土': '戊',
  '壁上土': '戊',
  '大驿土': '戊',
  '沙中土': '戊'
};
